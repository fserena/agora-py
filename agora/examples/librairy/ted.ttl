@prefix ted: <http://agora.org/ted#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix wot: <http://www.wot.org#> .
@prefix librairy: <http://drinventor.dia.fi.upm.es/vocabulary#> .


_:ted1 a ted:TED ;
       ted:describesEcosystem _:eco .

_:eco a ted:Ecosystem ;
      ted:includes _:ds, _:ts .

_:ds a librairy:DocumentService ;
      wot:identifier "ds" ;
      wot:onEndpoint [
          wot:href "http://drinventor.dia.fi.upm.es/api/0.2/documents"^^xsd:anyURI ;
          wot:mediaType "application/json" ;
          wot:mapping _:exposesDocMap
      ] .

_:exposesDocMap a wot:Mapping ;
      wot:key "exposes" ;
      wot:predicate librairy:exposesDocument ;
      wot:valueTransform _:doc .

_:doc a librairy:Document ;
      wot:identifier "doc" ;
      wot:onEndpoint [
        wot:href "http://drinventor.dia.fi.upm.es/api/0.2/documents/{{lslug($item)}}" ;
        wot:mediaType "application/json" ;
        wot:mapping _:titleMap , _:creationMap
      ] ;
      wot:includes [
        wot:predicate librairy:hasTopicDeals ;
        wot:object _:dealContainer
      ] .

_:titleMap a wot:Mapping ;
      wot:key "title" ;
      wot:predicate librairy:title .

_:creationMap a wot:Mapping ;
      wot:key "creationTime" ;
      wot:predicate librairy:creationTime .

_:dealContainer a librairy:TopicDealContainer ;
        wot:identifier "dcontainer" ;
        wot:onEndpoint [
            wot:href "http://drinventor.dia.fi.upm.es/api/0.2/documents/{{lslug($item)}}/topics" ;
            wot:mediaType "application/json" ;
            wot:mapping _:topicDealMap
          ] .

_:topicDealMap a wot:Mapping ;
      wot:key "deals" ;
      wot:predicate librairy:contains ;
      wot:valueTransform _:deal .

_:deal a librairy:TopicDeal ;
        wot:identifier "deal" ;
        wot:onEndpoint [
            wot:href "http://drinventor.dia.fi.upm.es/api/0.2/documents/{{lslug($parent)}}/topics/{{lslug($item)}}" ;
            wot:mediaType "application/json" ;
            wot:mapping _:weightMap ;
        ] ;
        wot:includes [
            wot:predicate librairy:forTopic ;
            wot:object _:topic
        ] .

_:weightMap a wot:Mapping ;
      wot:key "weight" ;
      wot:predicate librairy:weight .

_:topic a librairy:Topic ;
        wot:identifier "topic" ;
        wot:onEndpoint _:topicEnd .

_:topicEnd a wot:Endpoint ;
      wot:href "http://drinventor.dia.fi.upm.es/api/0.2/topics/{{lslug($item)}}" ;
      wot:mediaType "application/json" ;
      wot:mapping _:creationMap, _:contentMap .

_:contentMap a wot:Mapping ;
      wot:key "content" ;
      wot:predicate librairy:content .

_:ts a librairy:TopicService ;
      wot:identifier "ts" ;
      wot:onEndpoint [
          wot:href "http://drinventor.dia.fi.upm.es/api/0.2/topics"^^xsd:anyURI ;
          wot:mediaType "application/json" ;
          wot:mapping _:exposesTopicMap
      ] .

_:exposesTopicMap a wot:Mapping ;
      wot:key "exposes" ;
      wot:predicate librairy:exposesTopic ;
      wot:valueTransform _:topic .
