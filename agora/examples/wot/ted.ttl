@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix wot: <http://iot.linkeddata.es/def/wot#> .
@prefix map: <http://iot.linkeddata.es/def/wot-mappings#> .
@prefix core: <http://iot.linkeddata.es/def/core#> .


_:ted1 a core:ThingEcosystemDescription ;
    core:describes _:eco .

_:eco a core:Ecosystem ;
    core:hasComponent _:service, <http://es.dbpedia.org/resource/Madrid>,
                             <http://es.dbpedia.org/resource/A%C3%B1ora> .

<http://es.dbpedia.org/resource/Madrid> a <http://schema.org/Place> .
<http://es.dbpedia.org/resource/A%C3%B1ora> a <http://schema.org/Place> .

_:service a wot:Service .

_:td_service a wot:ThingDescription ;
    wot:identifier "service" ;
    wot:describes _:service ;
    map:hasAccessMapping [
        a map:AccessMapping ;
        map:mapsResourcesFrom [
            a wot:Endpoint ;
            wot:href "http://localhost:5005/things"^^xsd:anyURI ;
            wot:mediaType "application/json"
        ] ;
        map:hasMapping [
            a map:Mapping ;
            map:key "exposesWebThing" ;
            map:predicate wot:exposesWebThing ;
            map:valuesTransformedBy _:td_stars
        ]
    ] .

_:td_stars a wot:ThingDescription ;
    wot:identifier "stars" ;
    wot:describes [ a wot:Thing ] ;
    map:hasAccessMapping [
        a map:AccessMapping ;
        map:mapsResourcesFrom [
            a wot:Endpoint ;
            wot:href "$item" ;
            wot:mediaType "application/json"
        ] ;
        map:hasMapping _:id_map, _:creation_map, _:property_map
    ] .

_:id_map a map:Mapping ;
    map:key "identifier" ;
    map:predicate wot:identifier .

_:creation_map a map:Mapping ;
    map:key "creationDate" ;
    map:predicate wot:creationDate .

_:property_map a map:Mapping ;
    map:key "hasWebThingProperty" ;
    map:predicate wot:offersInteraction ;
    map:valuesTransformedBy _:td_property .

_:td_property a wot:ThingDescription ;
    wot:identifier "property" ;
    wot:describes [ a wot:Property ] ;
    map:hasAccessMapping [
        a map:AccessMapping ;
        map:mapsResourcesFrom [
            a wot:Endpoint ;
            wot:href "$item" ;
            wot:mediaType "application/json"
        ] ;
        map:hasMapping _:label_map, _:ts_map, _:latest_map, _:value_map
    ] .

_:label_map a map:Mapping ;
    map:key "label" ;
    map:predicate rdfs:label .

_:ts_map a map:Mapping ;
    map:key "entryTimeStamp" ;
    map:predicate wot:entryTimeStamp .

_:value_map a map:Mapping ;
    map:key "value" ;
    map:predicate wot:value .

_:latest_map a map:Mapping ;
    map:key "hasLatestEntry" ;
    map:predicate wot:hasLatestEntry .
